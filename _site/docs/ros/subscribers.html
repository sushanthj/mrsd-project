

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Building Subscribers and Publishers | Team Dock Dock Go!</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Building Subscribers and Publishers" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="MRSD project Team H’s system description" />
<meta property="og:description" content="MRSD project Team H’s system description" />
<link rel="canonical" href="http://localhost:4000/docs/ros/subscribers.html" />
<meta property="og:url" content="http://localhost:4000/docs/ros/subscribers.html" />
<meta property="og:site_name" content="Team Dock Dock Go!" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Building Subscribers and Publishers" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"MRSD project Team H’s system description","headline":"Building Subscribers and Publishers","url":"http://localhost:4000/docs/ros/subscribers.html"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
      <title>Link</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
      <title>Search</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
      <title>Menu</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
      <title>Expand</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
      <title>Document</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
      </svg>
    </symbol>
  </svg>

  <div class="side-bar">
    <div class="site-header">
      <a href="http://localhost:4000/" class="site-title lh-tight">
  Team Dock Dock Go!

</a>
      <a href="#" id="menu-button" class="site-button">
        <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
      </a>
    </div>
    <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      
        <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/Nav2" class="nav-list-link">Nav2</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/Nav2/costmap_updates.html" class="nav-list-link">Costmap Plugins</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/Simulation" class="nav-list-link">Simulation Development</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/Simulation/build_floorplan.html" class="nav-list-link">Gazebo Environment and Mapping</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/Simulation/model_basics.html" class="nav-list-link">Understand Model and World Files</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/Simulation/navigation.html" class="nav-list-link">Navigating in Simulation</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/Simulation/svd_demo.html" class="nav-list-link">Creating Custom World for SVD</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/Simulation/adding_lidar.html" class="nav-list-link">Adding Lidar in Simulation</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/robot_bringup" class="nav-list-link">Robot Bringup</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/robot_bringup/neobotix_orin_networking.html" class="nav-list-link">Neobotix-Orin Networking</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/robot_bringup/neobotix_compute.html" class="nav-list-link">Working on Neobotix Compute</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/robot_bringup/software_arch.html" class="nav-list-link">High Level Navigation and Comms Integration</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/robot_integration" class="nav-list-link">Robot Software Integration</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/robot_integration/neobotix_orin_networking.html" class="nav-list-link">PCL Localization Integration</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/ros" class="nav-list-link">ROS Learnings</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/ros/basics.html" class="nav-list-link">Basics</a></li><li class="nav-list-item  active"><a href="http://localhost:4000/docs/ros/subscribers.html" class="nav-list-link active">Building Subscribers and Publishers</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/intro/" class="nav-list-link">Building this Website</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/software_bringup" class="nav-list-link">Systems Setup</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/software_bringup/ros_setup_2.html" class="nav-list-link">ROS2 on the Jetson and Desktop</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/software_bringup/RealSense.html" class="nav-list-link">RealSense Setup</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/software_bringup/vscode.html" class="nav-list-link">VS Code Setup</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/software_bringup/docker_image_management.html" class="nav-list-link">Docker and Dockerhub</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/Mechanical" class="nav-list-link">Mechanical Development</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/Mechanical/frame.html" class="nav-list-link">Frame Design</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/SLAM_toolbox" class="nav-list-link">Understanding SLAM Toolbox</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/SLAM_Toolbox/running.html" class="nav-list-link">Running SLAM Toolbox</a></li><li class="nav-list-item "><a href="http://localhost:4000/docs/SLAM_Toolbox/setup.html" class="nav-list-link">Setup for SLAM Toolbox</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/docs/Localization" class="nav-list-link">Robot Localization</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/docs/Localization/AMCL.html" class="nav-list-link">AMCL</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/git_concepts" class="nav-list-link">Git Usage</a></li><li class="nav-list-item"><a href="http://localhost:4000/miscellaneous" class="nav-list-link">Miscellaneous yet Useful</a></li></ul>

      
    </nav>
    <footer class="site-footer">
      This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  </div>
  <div class="main" id="top">
    <div id="main-header" class="main-header">
      
        <div class="search">
          <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Team Dock Dock Go!" aria-label="Search Team Dock Dock Go!" autocomplete="off">
            <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
      
      
      
        <nav aria-label="Auxiliary" class="aux-nav">
          <ul class="aux-nav-list">
            
              <li class="aux-nav-list-item">
                <a href="https://github.com/orgs/DockDockGo/repositories" class="site-button"
                  
                >
                  Teams's GitHub
                </a>
              </li>
            
          </ul>
        </nav>
      
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list">
              
                <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/docs/ros">ROS Learnings</a></li>
              
              <li class="breadcrumb-nav-list-item"><span>Building Subscribers and Publishers</span></li>
            </ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">
        
          <details open="">
  <summary class="text-delta">
    Table of contents
  </summary>
<ol id="markdown-toc">
  <li><a href="#before-you-begin" id="markdown-toc-before-you-begin">Before You Begin</a>    <ol>
      <li><a href="#bare-minimum" id="markdown-toc-bare-minimum">Bare Minimum</a></li>
      <li><a href="#building-in-a-ros-package-setup" id="markdown-toc-building-in-a-ros-package-setup">Building in a ROS Package Setup</a>        <ol>
          <li><a href="#create-workspace-and-clone-an-existing-package" id="markdown-toc-create-workspace-and-clone-an-existing-package">Create Workspace and Clone an Existing Package</a></li>
          <li><a href="#now-lets-create-our-own-package" id="markdown-toc-now-lets-create-our-own-package">Now, let’s create our own package!</a>            <ol>
              <li><a href="#creating-the-package" id="markdown-toc-creating-the-package">Creating the Package</a></li>
            </ol>
          </li>
        </ol>
      </li>
    </ol>
  </li>
  <li><a href="#simple-example-subscriber-from-ros" id="markdown-toc-simple-example-subscriber-from-ros">Simple Example Subscriber from ROS</a></li>
  <li><a href="#subscriber-for-realsense-images" id="markdown-toc-subscriber-for-realsense-images">Subscriber for RealSense Images</a></li>
</ol>

</details>
      <h1 id="before-you-begin">
        
        
          <a href="#before-you-begin" class="anchor-heading" aria-labelledby="before-you-begin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Before You Begin
        
        
      </h1>
    
      <h2 id="bare-minimum">
        
        
          <a href="#bare-minimum" class="anchor-heading" aria-labelledby="bare-minimum"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bare Minimum
        
        
      </h2>
    
<p>Any subscriber we build can be run from any directory if it’s a python file as shown below</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 /home/test_subscriber.py
</code></pre></div></div>
      <h2 id="building-in-a-ros-package-setup">
        
        
          <a href="#building-in-a-ros-package-setup" class="anchor-heading" aria-labelledby="building-in-a-ros-package-setup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Building in a ROS Package Setup
        
        
      </h2>
    
      <h3 id="create-workspace-and-clone-an-existing-package">
        
        
          <a href="#create-workspace-and-clone-an-existing-package" class="anchor-heading" aria-labelledby="create-workspace-and-clone-an-existing-package"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create Workspace and Clone an Existing Package
        
        
      </h3>
    

<p>It’s good practice to develop all ros nodes, even the simplest ones within a package. To do <br />
so, we’ll need to follow the following steps:</p>

<ol>
  <li>Create a workspace in the following manner: <code class="language-plaintext highlighter-rouge">mkdir /home/ddg/dev_ws/src</code></li>
  <li>The above step will create a basic folder structure we’ll need to add new packages</li>
  <li>If you’re cloning an existing repository do the following (example using realsense ros2 wrappers)
<a href="https://github.com/IntelRealSense/realsense-ros">Reference</a>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">cd /home/ddg/dev_ws/src</code></li>
      <li><code class="language-plaintext highlighter-rouge">git clone https://github.com/IntelRealSense/realsense-ros.git -b ros2-development</code></li>
      <li><code class="language-plaintext highlighter-rouge">cd ~/ddg/dev_ws</code></li>
      <li>
        <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">sudo </span>apt-get <span class="nb">install </span>python3-rosdep <span class="nt">-y</span>
 <span class="nb">sudo </span>rosdep init <span class="c"># "sudo rosdep init --include-eol-distros" for Eloquent and earlier</span>
 rosdep update <span class="c"># "sudo rosdep update --include-eol-distros" for Eloquent and earlier</span>
 rosdep <span class="nb">install</span> <span class="nt">-i</span> <span class="nt">--from-path</span> src <span class="nt">--rosdistro</span> <span class="nv">$ROS_DISTRO</span> <span class="nt">--skip-keys</span><span class="o">=</span>librealsense2 <span class="nt">-y</span>
</code></pre></div>        </div>
      </li>
      <li><code class="language-plaintext highlighter-rouge">colcon build</code></li>
      <li><code class="language-plaintext highlighter-rouge">source /opt/ros/$ROS_DISTRO/setup.bash</code></li>
      <li><code class="language-plaintext highlighter-rouge">cd ~/ddg/dev_ws</code></li>
      <li><code class="language-plaintext highlighter-rouge">. install/local_setup.bash</code></li>
    </ul>
  </li>
  <li>Note that in the above step, colcon build setup the install folder since a package was created \</li>
  <li>If we don’t have any packages setup using colcon build, you’ll only have dev_ws/src which you created</li>
</ol>
      <h3 id="now-lets-create-our-own-package">
        
        
          <a href="#now-lets-create-our-own-package" class="anchor-heading" aria-labelledby="now-lets-create-our-own-package"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Now, let’s create our own package!
        
        
      </h3>
    

<p>A typical folder structure for a ros2 package will look like</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>my_package/
      setup.py
      package.xml
      resource/my_package
</code></pre></div></div>

<p>However, since we already have a workspace it should look more like</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>workspace_folder/
    src/
      package_1/
          CMakeLists.txt
          package.xml

      package_2/
          setup.py
          package.xml
          resource/package_2
      ...
      package_n/
          CMakeLists.txt
          package.xml
</code></pre></div></div>
      <h4 id="creating-the-package">
        
        
          <a href="#creating-the-package" class="anchor-heading" aria-labelledby="creating-the-package"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating the Package
        
        
      </h4>
    

<ol>
  <li><code class="language-plaintext highlighter-rouge">cd ~/ddg/dev_ws/src</code></li>
  <li><code class="language-plaintext highlighter-rouge">ros2 pkg create --build-type ament_python &lt;package_name&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">cd ~/ddg/dev_ws/</code></li>
  <li><code class="language-plaintext highlighter-rouge">colcon build --packages-select my_package</code> or to build all packages in workspace<code class="language-plaintext highlighter-rouge">colcon build</code></li>
  <li><code class="language-plaintext highlighter-rouge">. install/setup.bash</code> (uses the install directory created by colcon build)</li>
</ol>

<p>To run any node we develop in the package we can do</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ros2 run my_package my_node
</code></pre></div></div>
      <h1 id="simple-example-subscriber-from-ros">
        
        
          <a href="#simple-example-subscriber-from-ros" class="anchor-heading" aria-labelledby="simple-example-subscriber-from-ros"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Simple Example Subscriber from ROS
        
        
      </h1>
    

<p><a href="https://docs.ros.org/en/foxy/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html#id1">Reference</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="kn">from</span> <span class="nn">std_msgs.msg</span> <span class="kn">import</span> <span class="n">String</span>


<span class="k">class</span> <span class="nc">MinimalSubscriber</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="s">'minimal_subscriber'</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">subscription</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">create_subscription</span><span class="p">(</span>
            <span class="n">String</span><span class="p">,</span>
            <span class="s">'topic'</span><span class="p">,</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">listener_callback</span><span class="p">,</span>
            <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">subscription</span>  <span class="c1"># prevent unused variable warning
</span>
    <span class="k">def</span> <span class="nf">listener_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">get_logger</span><span class="p">().</span><span class="n">info</span><span class="p">(</span><span class="s">'I heard: "%s"'</span> <span class="o">%</span> <span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

    <span class="n">minimal_subscriber</span> <span class="o">=</span> <span class="n">MinimalSubscriber</span><span class="p">()</span>

    <span class="n">rclpy</span><span class="p">.</span><span class="n">spin</span><span class="p">(</span><span class="n">minimal_subscriber</span><span class="p">)</span>

    <span class="c1"># Destroy the node explicitly
</span>    <span class="c1"># (optional - otherwise it will be done automatically
</span>    <span class="c1"># when the garbage collector destroys the node object)
</span>    <span class="n">minimal_subscriber</span><span class="p">.</span><span class="n">destroy_node</span><span class="p">()</span>
    <span class="n">rclpy</span><span class="p">.</span><span class="n">shutdown</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>
      <h1 id="subscriber-for-realsense-images">
        
        
          <a href="#subscriber-for-realsense-images" class="anchor-heading" aria-labelledby="subscriber-for-realsense-images"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Subscriber for RealSense Images
        
        
      </h1>
    

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">rclpy</span>
<span class="kn">from</span> <span class="nn">rclpy.node</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="kn">from</span> <span class="nn">sensor_msgs.msg</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">from</span> <span class="nn">cv_bridge</span> <span class="kn">import</span> <span class="n">CvBridge</span>


<span class="k">class</span> <span class="nc">ImageDumperSubscriber</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="s">'minimal_subscriber'</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">_bridge</span> <span class="o">=</span> <span class="n">CvBridge</span><span class="p">()</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">_color_subscription</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">create_subscription</span><span class="p">(</span>
            <span class="n">Image</span><span class="p">,</span> <span class="c1">#msg_type 
</span>            <span class="s">'/camera/color/image_raw'</span><span class="p">,</span> <span class="c1">#topic
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">_color_listener_callback</span><span class="p">,</span>  <span class="c1"># callback
</span>            <span class="mi">10</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">depth_subscription</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">create_subscription</span><span class="p">(</span>
            <span class="n">Image</span><span class="p">,</span> <span class="c1">#msg_type 
</span>            <span class="s">'/camera/depth/image_rect_raw'</span><span class="p">,</span> <span class="c1">#topic
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">_depth_listener_callback</span><span class="p">,</span>  <span class="c1"># callback
</span>            <span class="mi">10</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="nf">_color_listener_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="n">image_cv2</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_bridge</span><span class="p">.</span><span class="n">imgmsg_to_cv2</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s">"bgr8"</span><span class="p">)</span> 
        <span class="bp">self</span><span class="p">.</span><span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">get_logger</span><span class="p">().</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">'I heard: </span><span class="si">{</span><span class="n">msg</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">_depth_listener_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="n">image_cv2</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_bridge</span><span class="p">.</span><span class="n">imgmsg_to_cv2</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s">"passthrough"</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">get_logger</span><span class="p">().</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s">'I heard: </span><span class="si">{</span><span class="n">msg</span><span class="p">.</span><span class="n">header</span><span class="p">.</span><span class="n">frame_id</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">rclpy</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

    <span class="n">minimal_subscriber</span> <span class="o">=</span> <span class="n">ImageDumperSubscriber</span><span class="p">()</span>
    <span class="n">rclpy</span><span class="p">.</span><span class="n">spin</span><span class="p">(</span><span class="n">minimal_subscriber</span><span class="p">)</span>

    <span class="c1"># Destroy the node explicitly
</span>    <span class="c1"># (optional - otherwise it will be done automatically
</span>    <span class="c1"># when the garbage collector destroys the node object)
</span>    <span class="n">minimal_subscriber</span><span class="p">.</span><span class="n">destroy_node</span><span class="p">()</span>
    <span class="n">rclpy</span><span class="p">.</span><span class="n">shutdown</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

        

        

        
        
          <hr>
          <footer>
            

            <p class="text-small text-grey-dk-100 mb-0"></p>

            
              <div class="d-flex mt-2">
                
                
              </div>
            
          </footer>
        

      </div>
    </div>

    
      

      <div class="search-overlay"></div>
    
  </div>
</body>
</html>

